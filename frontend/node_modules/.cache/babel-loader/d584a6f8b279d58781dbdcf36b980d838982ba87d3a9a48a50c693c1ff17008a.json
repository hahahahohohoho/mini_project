{"ast":null,"code":"var _jsxFileName = \"C:\\\\LEECHANGSU_MAIN\\\\mini_project\\\\frontend\\\\src\\\\Busan\\\\Main.js\",\n  _s = $RefreshSig$();\nimport React from 'react';\nimport { useRef, useState } from 'react';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function Main() {\n  _s();\n  const mapElement = useRef < HTMLDivElement | null > null;\n  const [AddressX, setAddressX] = useState < number > 0;\n  const [AddressY, setAddressY] = useState < number > 0;\n  const {\n    naver\n  } = window;\n  const [newMap, setNewMap] = useState < naver.maps.Map | null > null;\n  let map;\n  const createMarkerList = [];\n  useEffect(() => {\n    if (searchKeyword) {\n      naver.maps.Service.geocode({\n        query: searchKeyword\n      }, function (status, res) {\n        if (res.v2.addresses.length === 0) {\n          // 요청실패 (searchKeyword에 대한 응답이 없을 경우) 에러 핸들링\n        } else {\n          // 요청 성공에 대한 핸들링\n          // 검색된 주소에 해당하는 위도, 경도를 숫자로 변환후 상태 저장\n          const resAddress = res.v2.addresses[0];\n          const x = parseFloat(resAddress.x);\n          const y = parseFloat(resAddress.y);\n          setAddressX(x);\n          setAddressY(y);\n        }\n      });\n    }\n  }, [searchKeyword]);\n  useEffect(() => {\n    if (!mapElement.current || !naver) return;\n\n    // Map 클래스는 지도를 표현하는 클래스\n    // new 연산자를 이용하여 새 인스턴스를 생성\n    // 변환해놓은 좌표값을 이용하여 지도 중심 인스턴스 생성\n    const center = new naver.maps.LatLng(AddressY, AddressX);\n    //지도 옵션 설정\n    const mapOptions = {\n      //center 옵션에 생성한 지도 중심 인스턴스 넣기\n      center: center,\n      zoom: 12,\n      minZoom: 11,\n      maxZoom: 19,\n      zoomControl: true,\n      zoomControlOptions: {\n        style: naver.maps.ZoomControlStyle.SMALL,\n        position: naver.maps.Position.TOP_RIGHT\n      },\n      mapDataControl: false,\n      scaleControl: false\n    };\n    //설정해놓은 옵션을 바탕으로 지도 생성\n    map = new naver.maps.Map(mapElement.current, mapOptions);\n    setNewMap(map);\n    //마커 생성 함수 호출\n    addMarkers();\n    //검색 결과 거리순으로 재정렬하는 함수 호출\n    resetListHandler();\n  }, [AddressX, AddressY, totalDomData, viewportWidth]);\n\n  //반복문을 통해 데이터 배열 순회하면서 마커 생성 진행!\n  const addMarkers = () => {\n    for (let i = 0; i < totalDataArray.length; i++) {\n      let markerObj = totalDataArray[i];\n      const {\n        dom_id,\n        title,\n        lat,\n        lng\n      } = markerObj;\n      addMarker(dom_id, title, lat, lng);\n    }\n  };\n  //마커 생성 하고 createMarkerList에 추가!!\n  const addMarker = (id, name, lat, lng) => {\n    try {\n      let newMarker = new naver.maps.Marker({\n        position: new naver.maps.LatLng(lng, lat),\n        map,\n        title: name,\n        clickable: true\n      });\n      newMarker.setTitle(name);\n      //마커리스트에 추가\n      createMarkerList.push(newMarker);\n      //마커에 이벤트 핸들러 등록\n      naver.maps.Event.addListener(newMarker, 'click', () => markerClickHandler(id));\n    } catch (e) {}\n  };\n  const updateMarkers = (map, markers) => {\n    if (!map) return;\n    // 현재 지도의 화면 영역을 mapBounds 변수에 저장\n    let mapBounds = map.getBounds();\n    let marker, position;\n\n    // 마커 객체 배열을 순회하며 각 마커의 위치를 position 변수에 저장   \n    for (var i = 0; i < markers.length; i++) {\n      marker = markers[i];\n      position = marker.getPosition();\n\n      // mapBounds와 비교하며 마커가 현재 화면에 보이는 영역에 있는지 확인\n      if (mapBounds.hasPoint(position)) {\n        // 보이는 영역에 있다면 마커 표시\n        showMarker(map, marker);\n      } else {\n        // 숨겨진 영역에 있다면 마커 숨김 \n        hideMarker(marker);\n      }\n    }\n  };\n\n  //마커를 클릭했을 때 실행할 이벤트 핸들러\n  const markerClickHandler = id => {\n    navigate(`/ground/${id}`);\n  };\n  //이벤트 핸들러 등록\n  useEffect(() => {\n    if (newMap) {\n      const MoveEventListner = naver.maps.Event.addListener(newMap, 'idle', idleHandler);\n      return () => {\n        naver.maps.Event.removeListener(MoveEventListner);\n      };\n    }\n  }, [newMap]);\n  const idleHandler = () => {\n    updateMarkers(newMap, createMarkerList);\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: /*#__PURE__*/_jsxDEV(StyledMap, {\n      id: \"map\",\n      ref: mapElement\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 136,\n    columnNumber: 5\n  }, this);\n}\n_s(Main, \"ewq31d5h+FnD/qJW52w5UqeNMN4=\");\n_c = Main;\nvar _c;\n$RefreshReg$(_c, \"Main\");","map":{"version":3,"names":["React","useRef","useState","jsxDEV","_jsxDEV","Main","_s","mapElement","HTMLDivElement","AddressX","setAddressX","number","AddressY","setAddressY","naver","window","newMap","setNewMap","maps","Map","map","createMarkerList","useEffect","searchKeyword","Service","geocode","query","status","res","v2","addresses","length","resAddress","x","parseFloat","y","current","center","LatLng","mapOptions","zoom","minZoom","maxZoom","zoomControl","zoomControlOptions","style","ZoomControlStyle","SMALL","position","Position","TOP_RIGHT","mapDataControl","scaleControl","addMarkers","resetListHandler","totalDomData","viewportWidth","i","totalDataArray","markerObj","dom_id","title","lat","lng","addMarker","id","name","newMarker","Marker","clickable","setTitle","push","Event","addListener","markerClickHandler","e","updateMarkers","markers","mapBounds","getBounds","marker","getPosition","hasPoint","showMarker","hideMarker","navigate","MoveEventListner","idleHandler","removeListener","children","StyledMap","ref","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["C:/LEECHANGSU_MAIN/mini_project/frontend/src/Busan/Main.js"],"sourcesContent":["import React from 'react'\r\nimport { useRef,useState } from 'react';\r\nexport default function Main() {\r\n    const mapElement = useRef<HTMLDivElement | null>(null);\r\n    const [AddressX, setAddressX] = useState<number>(0);\r\n    const [AddressY, setAddressY] = useState<number>(0);\r\n    const { naver } = window;\r\n    const [newMap, setNewMap] = useState<naver.maps.Map | null>(null);\r\n    let map;\r\n    const createMarkerList = [];\r\n    \r\n    useEffect(() => {\r\n        if (searchKeyword) {\r\n          naver.maps.Service.geocode(\r\n            { query: searchKeyword },\r\n            function (status, res) {\r\n              if (res.v2.addresses.length === 0) {\r\n                // 요청실패 (searchKeyword에 대한 응답이 없을 경우) 에러 핸들링\r\n              } else {\r\n                // 요청 성공에 대한 핸들링\r\n                // 검색된 주소에 해당하는 위도, 경도를 숫자로 변환후 상태 저장\r\n                const resAddress = res.v2.addresses[0];\r\n                const x = parseFloat(resAddress.x);\r\n                const y = parseFloat(resAddress.y);\r\n                setAddressX(x);\r\n                setAddressY(y);\r\n              }\r\n            }\r\n          );\r\n        }\r\n      }, [searchKeyword]);\r\n      \r\n      useEffect(() => {\r\n        if (!mapElement.current || !naver) return;\r\n    \r\n        // Map 클래스는 지도를 표현하는 클래스\r\n        // new 연산자를 이용하여 새 인스턴스를 생성\r\n        // 변환해놓은 좌표값을 이용하여 지도 중심 인스턴스 생성\r\n        const center = new naver.maps.LatLng(AddressY, AddressX);\r\n        //지도 옵션 설정\r\n        const mapOptions = {\r\n          //center 옵션에 생성한 지도 중심 인스턴스 넣기\r\n          center: center,\r\n          zoom: 12,\r\n          minZoom: 11,\r\n          maxZoom: 19,\r\n          zoomControl: true,\r\n          zoomControlOptions: {\r\n            style: naver.maps.ZoomControlStyle.SMALL,\r\n            position: naver.maps.Position.TOP_RIGHT,\r\n          },\r\n          mapDataControl: false,\r\n          scaleControl: false,\r\n        };\r\n        //설정해놓은 옵션을 바탕으로 지도 생성\r\n        map = new naver.maps.Map(mapElement.current, mapOptions);\r\n        setNewMap(map);\r\n        //마커 생성 함수 호출\r\n        addMarkers();\r\n        //검색 결과 거리순으로 재정렬하는 함수 호출\r\n        resetListHandler();\r\n      }, [AddressX, AddressY, totalDomData, viewportWidth]);\r\n\r\n      //반복문을 통해 데이터 배열 순회하면서 마커 생성 진행!\r\n  const addMarkers = () => {\r\n    for (let i = 0; i < totalDataArray.length; i++) {\r\n      let markerObj = totalDataArray[i];\r\n      const { dom_id, title, lat, lng } = markerObj;\r\n      addMarker(dom_id, title, lat, lng);\r\n    }\r\n  };\r\n  //마커 생성 하고 createMarkerList에 추가!!\r\n  const addMarker = (id, name, lat, lng) => {\r\n    try {\r\n      let newMarker = new naver.maps.Marker({\r\n        position: new naver.maps.LatLng(lng, lat),\r\n        map,\r\n        title: name,\r\n        clickable: true,\r\n      });\r\n      newMarker.setTitle(name);\r\n      //마커리스트에 추가\r\n      createMarkerList.push(newMarker);\r\n      //마커에 이벤트 핸들러 등록\r\n      naver.maps.Event.addListener(newMarker, 'click', () =>\r\n        markerClickHandler(id)\r\n      );\r\n    } catch (e) {}\r\n  };\r\n\r\n  const updateMarkers = (map,markers) => {\r\n    if (!map) return;\r\n    // 현재 지도의 화면 영역을 mapBounds 변수에 저장\r\n    let mapBounds = map.getBounds();\r\n    let marker, position;\r\n    \r\n    // 마커 객체 배열을 순회하며 각 마커의 위치를 position 변수에 저장   \r\n    for (var i = 0; i < markers.length; i++) {\r\n      marker = markers[i];\r\n      position = marker.getPosition();\r\n      \r\n      // mapBounds와 비교하며 마커가 현재 화면에 보이는 영역에 있는지 확인\r\n      if (mapBounds.hasPoint(position)) {\r\n        // 보이는 영역에 있다면 마커 표시\r\n        showMarker(map, marker);\r\n      } else {\r\n        // 숨겨진 영역에 있다면 마커 숨김 \r\n        hideMarker(marker);\r\n      }\r\n    }\r\n  };\r\n\r\n  //마커를 클릭했을 때 실행할 이벤트 핸들러\r\n  const markerClickHandler = (id) => {\r\n    navigate(`/ground/${id}`);\r\n  };\r\n  //이벤트 핸들러 등록\r\n  useEffect(() => {\r\n    if (newMap) {\r\n      const MoveEventListner = naver.maps.Event.addListener(\r\n        newMap,\r\n        'idle',\r\n        idleHandler\r\n      );\r\n      return () => {\r\n        naver.maps.Event.removeListener(MoveEventListner);\r\n      };\r\n    }\r\n  }, [newMap]);\r\n\r\n  const idleHandler = () => {\r\n    updateMarkers(newMap, createMarkerList);\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <StyledMap id=\"map\" ref={mapElement}></StyledMap> \r\n    </div>\r\n  )\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}